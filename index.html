<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>CareNexus AI : Ultimate Fixed</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ========== Base Design ========== */
:root { 
    --primary: #2563eb; 
    --primary-light: #eff6ff;
    --text-main: #111827; 
    --text-sub: #6b7280;
    --bg-body: #f3f4f6; 
    --bg-panel: #ffffff;
    --border: #e5e7eb;
    --danger: #ef4444; 
    --success: #10b981;
    --warning: #f59e0b;
    --nav-height: 60px;
}
body { margin: 0; background: var(--bg-body); color: var(--text-main); font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif; -webkit-font-smoothing: antialiased; padding-bottom: calc(var(--nav-height) + 20px); }
* { box-sizing: border-box; }

/* ========== Utility ========== */
.hidden { display: none !important; }
.card { background: var(--bg-panel); border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); margin-bottom: 16px; }
.btn { display: inline-flex; align-items: center; justify-content: center; padding: 10px 16px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; transition: 0.2s; }
.btn-primary { background: var(--primary); color: #fff; width: 100%; }
.btn-primary:active { opacity: 0.8; }
.input-field { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 16px; font-size: 16px; background: #fff; }

/* ========== Login Screen ========== */
#login-view {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%);
    z-index: 9999;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 24px;
}
.login-logo { font-size: 24px; font-weight: 800; color: var(--primary); margin-bottom: 8px; }
.login-sub { color: var(--text-sub); margin-bottom: 32px; }

/* ========== Main Layout ========== */
/* 初期状態ではメイン画面は隠す */
#main-view { display: none; }

header { 
    background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
    position: sticky; top: 0; z-index: 100;
    padding: 12px 16px; border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.header-title { font-size: 18px; font-weight: 700; color: var(--primary); }

/* ========== Tab Content Control ========== */
.tab-content { display: none; animation: fadeIn 0.3s ease; }
.tab-content.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

/* ========== Specific Pages ========== */
/* Home */
.stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
.stat-card { background: #fff; padding: 12px; border-radius: 8px; text-align: center; border: 1px solid var(--border); }
.stat-val { font-size: 20px; font-weight: 700; color: var(--primary); }
.stat-label { font-size: 12px; color: var(--text-sub); }

/* Patient List */
.patient-item { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid var(--border); cursor: pointer; }
.patient-avatar { width: 40px; height: 40px; background: var(--primary-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-weight: 700; margin-right: 12px; }

/* Record Input */
.record-mic-btn { width: 60px; height: 60px; border-radius: 50%; background: var(--danger); color: white; font-size: 24px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3); }

/* ========== Bottom Nav ========== */
.bottom-nav {
    position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height);
    background: #fff; border-top: 1px solid var(--border);
    display: flex; justify-content: space-around; align-items: center;
    z-index: 500;
}
.nav-item {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    color: var(--text-sub); font-size: 10px; width: 100%; height: 100%;
    cursor: pointer;
}
.nav-item i { font-size: 20px; margin-bottom: 4px; }
.nav-item.active { color: var(--primary); }

</style>
</head>
<body>

<section id="login-view">
    <div class="login-logo"><i class="fa-solid fa-notes-medical"></i> CareNexus AI</div>
    <div class="login-sub">訪問看護業務支援プラットフォーム</div>
    
    <div style="width:100%; max-width:320px;">
        <input type="text" class="input-field" placeholder="ユーザーID" value="nurse01">
        <input type="password" class="input-field" placeholder="パスワード" value="password">
        <button class="btn btn-primary" onclick="appLogin()">ログイン</button>
    </div>
    <p style="margin-top:20px; font-size:12px; color:#999;">デモ版: そのままログインを押してください</p>
</section>

<div id="main-view">
    
    <header>
        <div class="header-title">CareNexus AI</div>
        <div style="font-size:20px; color:var(--text-sub);"><i class="fa-solid fa-bell"></i></div>
    </header>

    <div style="padding:16px;">

        <div id="tab-home" class="tab-content active">
            <h2 style="font-size:18px; margin:0 0 12px 0;">本日のサマリー <span style="font-size:14px; color:var(--text-sub); font-weight:400;">12月16日(火)</span></h2>
            
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-val">5</div>
                    <div class="stat-label">訪問予定</div>
                </div>
                <div class="stat-card">
                    <div class="stat-val" style="color:var(--danger);">1</div>
                    <div class="stat-label">要確認</div>
                </div>
            </div>

            <div class="card">
                <h3 style="font-size:16px; margin:0 0 10px 0;"><i class="fa-solid fa-triangle-exclamation" style="color:var(--warning);"></i> アラート: 佐藤 タケ様</h3>
                <p style="font-size:14px; color:var(--text-sub);">SpO2値が基準を下回る傾向が見られます(93%)。次回の訪問時に重点確認してください。</p>
            </div>

            <div class="card">
                <h3 style="font-size:16px; margin:0 0 10px 0;">AI推奨ルート</h3>
                <div style="font-size:14px; line-height:1.6;">
                    <div>09:00 山田 ハナ様 (定期)</div>
                    <div style="color:var(--text-sub); font-size:12px; margin-bottom:8px; padding-left:10px;">↓ 移動 15分 (渋滞なし)</div>
                    <div>10:15 佐藤 タケ様 (処置)</div>
                    <div style="color:var(--text-sub); font-size:12px; margin-bottom:8px; padding-left:10px;">↓ 移動 10分</div>
                    <div>11:30 鈴木 一郎様 (入浴)</div>
                </div>
            </div>
        </div>

        <div id="tab-schedule" class="tab-content">
            <h2 style="font-size:18px; margin-bottom:12px;">訪問スケジュール</h2>
            <div class="card">
                <div style="display:flex; justify-content:space-between; border-bottom:1px solid #eee; padding-bottom:8px; margin-bottom:8px;">
                    <strong>09:00 - 10:00</strong>
                    <span class="badge" style="background:#dbeafe; color:#1e40af; padding:2px 8px; border-radius:4px; font-size:12px;">実施済</span>
                </div>
                <div>山田 ハナ様 (要介護3)</div>
                <div style="font-size:12px; color:var(--text-sub);">バイタル測定、褥瘡処置</div>
            </div>

            <div class="card" style="border-left: 4px solid var(--primary);">
                <div style="display:flex; justify-content:space-between; border-bottom:1px solid #eee; padding-bottom:8px; margin-bottom:8px;">
                    <strong>10:15 - 11:15</strong>
                    <span class="badge" style="background:#fef3c7; color:#92400e; padding:2px 8px; border-radius:4px; font-size:12px;">移動中</span>
                </div>
                <div>佐藤 タケ様 (要介護4)</div>
                <div style="font-size:12px; color:var(--text-sub);">インスリン注射、入浴介助</div>
                <button class="btn btn-primary" style="margin-top:8px; font-size:12px; padding:6px;">記録を開始</button>
            </div>
        </div>

        <div id="tab-record" class="tab-content">
            <h2 style="font-size:18px; margin-bottom:12px;">実施記録入力</h2>
            
            <div class="card">
                <label style="display:block; font-size:12px; margin-bottom:4px; color:var(--text-sub);">対象利用者</label>
                <select class="input-field" style="margin-bottom:12px;">
                    <option>佐藤 タケ様</option>
                    <option>山田 ハナ様</option>
                </select>

                <div style="text-align:center; margin: 20px 0;">
                    <button class="record-mic-btn" onclick="startVoiceInput()"><i class="fa-solid fa-microphone"></i></button>
                    <p style="font-size:12px; color:var(--text-sub);">タップして音声入力開始</p>
                </div>

                <label style="display:block; font-size:12px; margin-bottom:4px; color:var(--text-sub);">記録内容 (AI自動生成)</label>
                <textarea id="aiInputMemo" class="input-field" rows="5" placeholder="音声認識結果がここに表示されます..."></textarea>
                
                <div style="display:flex; gap:10px;">
                    <button class="btn" style="background:#eee; color:#333; flex:1;">一時保存</button>
                    <button class="btn btn-primary" style="flex:1;">完了・送信</button>
                </div>
            </div>

            <div class="card">
                <h3 style="font-size:16px;">バイタル推移 (佐藤様)</h3>
                <div style="height:200px; position:relative;">
                    <canvas id="vitalChart"></canvas>
                </div>
            </div>
        </div>

        <div id="tab-patients" class="tab-content">
            <h2 style="font-size:18px; margin-bottom:12px;">担当利用者一覧</h2>
            <div style="background:#fff; border-radius:12px; overflow:hidden; border:1px solid var(--border);">
                <div class="patient-item">
                    <div class="patient-avatar">山</div>
                    <div>
                        <div style="font-weight:600;">山田 ハナ様</div>
                        <div style="font-size:12px; color:var(--text-sub);">要介護3 / 褥瘡リスクあり</div>
                    </div>
                </div>
                <div class="patient-item">
                    <div class="patient-avatar" style="background:#fce7f3; color:#be185d;">佐</div>
                    <div>
                        <div style="font-weight:600;">佐藤 タケ様</div>
                        <div style="font-size:12px; color:var(--text-sub);">要介護4 / 糖尿病管理</div>
                    </div>
                </div>
                <div class="patient-item">
                    <div class="patient-avatar" style="background:#dcfce7; color:#15803d;">鈴</div>
                    <div>
                        <div style="font-weight:600;">鈴木 一郎様</div>
                        <div style="font-size:12px; color:var(--text-sub);">要介護2 / リハビリ重点</div>
                    </div>
                </div>
            </div>
        </div>

    </div> <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home', this)">
            <i class="fa-solid fa-house"></i>
            <span>ホーム</span>
        </div>
        <div class="nav-item" onclick="switchTab('schedule', this)">
            <i class="fa-solid fa-calendar-check"></i>
            <span>予定</span>
        </div>
        <div class="nav-item" onclick="startRecordMock()">
            <div style="width:40px; height:40px; background:var(--primary); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; margin-bottom:0; transform:translateY(-10px); box-shadow:0 4px 8px rgba(37, 99, 235, 0.4);">
                <i class="fa-solid fa-pen" style="font-size:18px; margin:0;"></i>
            </div>
        </div>
        <div class="nav-item" onclick="switchTab('patients', this)">
            <i class="fa-solid fa-users"></i>
            <span>利用者</span>
        </div>
        <div class="nav-item" onclick="switchTab('settings', this)"> <i class="fa-solid fa-gear"></i>
            <span>設定</span>
        </div>
    </nav>

</div> <script>
    // --- 1. Login Logic ---
    function appLogin() {
        // Hide Login Screen
        document.getElementById('login-view').style.display = 'none';
        // Show Main App
        document.getElementById('main-view').style.display = 'block';
        // Init Charts or Data if needed
        setTimeout(initChart, 500); // Wait for visibility
    }

    // --- 2. Tab Switching Logic ---
    function switchTab(tabName, navEl) {
        // 1. Hide all contents
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(el => el.classList.remove('active'));

        // 2. Show target content
        const target = document.getElementById('tab-' + tabName);
        if(target) {
            target.classList.add('active');
        }

        // 3. Update Bottom Nav appearance
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(el => el.classList.remove('active'));
        if(navEl) {
            navEl.classList.add('active');
        }
    }

    // Special handler for the center "Record" button
    function startRecordMock() {
        // Manually switch to record tab
        const navItems = document.querySelectorAll('.nav-item');
        switchTab('record', null); // null because the center button design is different
    }

    // --- 3. Feature Logic (Preserved from original) ---
    function startVoiceInput() { 
        alert("音声認識を開始します..."); 
        document.getElementById('aiInputMemo').value += " [音声認識]: 10時20分、バイタル測定実施。血圧130/85、安定しています。食事摂取量は8割。"; 
    }

    let chart; 
    function initChart() { 
        const ctx = document.getElementById('vitalChart');
        if(!ctx) return;
        
        if(chart) chart.destroy();

        chart = new Chart(ctx.getContext('2d'), { 
            type:'line', 
            data:{
                labels:['12/12','12/13','12/14','12/15','今回'], 
                datasets:[
                    {label:'血圧上',data:[128,132,130,129,135],borderColor:'#ef4444',yAxisID:'y', tension:0.3}, 
                    {label:'血圧下',data:[80,82,78,80,85],borderColor:'#fca5a5',yAxisID:'y', tension:0.3},
                    {label:'SpO2',data:[98,97,98,96,93],borderColor:'#10b981',yAxisID:'y1', borderDash:[5,5]}
                ]
            }, 
            options:{
                maintainAspectRatio:false, 
                responsive: true,
                interaction: { mode: 'index', intersect: false },
                scales:{
                    y:{position:'left', title:{display:true, text:'血圧'}}, 
                    y1:{position:'right', min:90, max:100, grid:{drawOnChartArea:false}, title:{display:true, text:'SpO2'}}
                }
            }
        }); 
    }
</script>
</body>
</html>
